# =============================================================================
# tmux.conf â€” personal configuration
# =============================================================================

# --- Terminal & Colors -------------------------------------------------------
set -g default-terminal "tmux-256color"
set -sa terminal-overrides ',*256col*:RGB'  # true color support
set -sa terminal-overrides ',*:dim=\E[2m'   # fix dim mode

# --- Core Settings -----------------------------------------------------------
set -s escape-time 10                # fast Escape for vim (10ms)
set -g focus-events on               # vim gitgutter/ALE/LSP refresh on pane focus
set -g base-index 1                  # windows start at 1
setw -g pane-base-index 1            # panes start at 1 (consistent)
set -g renumber-windows on
set -g history-limit 999999
set -g display-panes-time 2000       # more time to see pane numbers
set -g mouse on

# --- Vi Mode -----------------------------------------------------------------
set -g status-keys vi
setw -g mode-keys vi

# --- Clipboard (Wayland / X11 auto-detect) -----------------------------------
if-shell 'test -n "$WAYLAND_DISPLAY"' \
  'set -s copy-command "wl-copy"' \
  'set -s copy-command "xsel -i --clipboard"'

bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi V send-keys -X select-line
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel

# --- Status Bar --------------------------------------------------------------
set -g status-position bottom
set -g status-justify centre
set -g status-style "bg=black,fg=default"

set -g status-left-length 50
set -g status-left "#[reverse] #h #[noreverse] #S "

set -g status-right-length 50
set -g status-right "#[noreverse] %d/%m/%Y #[reverse] %H:%M "

# --- Window Labels -----------------------------------------------------------
set -g automatic-rename on
set -g automatic-rename-format "#{b:pane_current_path}"
set -g window-status-format " #I #W#F "
set -g window-status-current-format " #I #W#F "
set -g window-status-current-style reverse

# --- Messages ----------------------------------------------------------------
set -g message-style bg=default,fg=default
set -g message-command-style bg=default,fg=default

# --- Panes -------------------------------------------------------------------
set -g pane-border-status top
set -g pane-border-style fg=colour8
set -g pane-active-border-style fg=colour6
set -g pane-border-format "#{?pane_active,#[bold],#[dim]}  #{pane_current_command} [#{b:pane_current_path}]  "

# --- Clock -------------------------------------------------------------------
set -g clock-mode-colour cyan
set -g clock-mode-style 24

# --- Key Bindings: Windows & Panes ------------------------------------------
# New windows/panes inherit current path
bind c new-window -c "#{pane_current_path}"
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# Vim-style pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Vim-style pane resize (repeatable)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# --- Key Bindings: Sessions & Utility ---------------------------------------
bind S command-prompt -p "New session:" "new-session -s '%%'"
bind Space last-window
bind-key r source-file ~/.tmux.conf \; display-message "tmux.conf reloaded"
